---
id: 2dc9b854
title: "Improve @ file picker with cached fuzzy matching"
tags: [enhancement, tui]
status: open
created_at: "2026-02-10T17:02:12.979Z"
---

In `packages/tui/src/autocomplete.ts`, `CombinedAutocompleteProvider`:

1. Add a cached file list field (e.g. `fdCache: Array<{path, isDirectory}> | null`)
2. On first `@` trigger, spawn `fd` once with no query filter (limit ~5000-10000 entries), store in cache
3. In `getFuzzyFileSuggestions()`, replace fd-with-query + scoreEntry with `fuzzyFilter` from `fuzzy.ts` against the cached list
4. Invalidate cache when autocomplete closes (or after a timeout)

### Affected files
- `packages/tui/src/autocomplete.ts` — main change
- `packages/tui/test/autocomplete.test.ts` — update tests
