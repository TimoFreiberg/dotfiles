---
id: aa69d060
title: "LSP: No AbortSignal propagation to LSP requests"
tags: [minor, lsp]
status: open
created_at: "2026-02-18T19:13:46.355Z"
---

**Minor** — The `execute` function in `index.ts` receives `signal: AbortSignal` but never passes it to `LspClient.request()`. If the user cancels a tool call (e.g., via Escape), the underlying LSP request still runs to completion or until the 30s timeout.

**Fix:** Add optional `signal` support to `LspClient.request()`:
```typescript
private request(method: string, params: any, signal?: AbortSignal): Promise<any> {
  return new Promise((resolve, reject) => {
    if (signal?.aborted) return reject(new Error("Cancelled"));
    const onAbort = () => { this.pending.delete(id); clearTimeout(timer); reject(new Error("Cancelled")); };
    signal?.addEventListener("abort", onAbort, { once: true });
    // ... existing logic, clean up listener on resolve/reject ...
  });
}
```

Then thread `signal` through from `execute` → `resolvePosition` → individual LSP calls.
