---
id: 1730efd9
title: "LSP: Apply output truncation to prevent context overflow"
tags: [important, lsp]
status: open
created_at: "2026-02-18T19:13:18.256Z"
---

**Important** â€” The pi extension docs emphasize *"Tools MUST truncate their output"* and provide `truncateHead`/`truncateTail` utilities with a 50KB / 2000 line default. The tool caps references at 100 and workspace symbols at 50 (good), but doesn't apply a byte-level cap.

A `hover` result with massive auto-generated docs, or a `definition` hitting many overloads with `extractContext` for each, could blow past 50KB.

**Fix:** Import and apply `truncateHead` from `@mariozechner/pi-coding-agent` as a final pass in `okResult()`, or at least cap the total result string size before returning.
